E = 200E9;
Nu = 0.25;

Point = cell(1,50);
Point	{	1	}	=	[	0	0.05	];
Point	{	2	}	=	[	0.02	0.046	];
Point	{	3	}	=	[	0.036	0.035	];
Point	{	4	}	=	[	0.046	0.02];
Point	{	5	}	=	[	0.05	0	];
Point	{	6	}	=	[	0	0.06	];
Point	{	7	}	=	[	0.03	0.06	];  
Point	{	8	}	=	[	0.06	0.06	];
Point	{	9	}	=	[	0.06	0.03	];
Point	{	10	}	=	[	0.06	0	];
Point	{	11	}	=	[	0	0.08	];
Point	{	12	}	=	[	0.03	0.08	];
Point	{	13	}	=	[	0.06	0.08	];
Point	{	14	}	=	[	0.08	0.08	];
Point	{	15	}	=	[	0.08	0.06	];
Point	{	16	}	=	[	0.08	0.03	];
Point	{	17	}	=	[	0.08	0	];
Point	{	18	}	=	[	0	0.1	];
Point	{	19	}	=	[	0.03	0.1	];
Point	{	20	}	=	[	0.06	0.1	];
Point	{	21	}	=	[	0.08	0.1	];
Point	{	22	}	=	[	0.1	0.1	];
Point	{	23	}	=	[	0.1	0.08	];
Point	{	24	}	=	[	0.1	0.06	];
Point	{	25	}	=	[	0.1	0.03	];
Point	{	26	}	=	[	0.1	0	];
Point	{	27	}	=	[	0	0.125	];
Point	{	28	}	=	[	0.03	0.125	];
Point	{	29	}	=	[	0.06	0.125	];
Point	{	30	}	=	[	0.08	0.125	];
Point	{	31	}	=	[	0.1	0.125	];
Point	{	32	}	=	[	0.15	0.125	];
Point	{	33	}	=	[	0.15	0.1	];
Point	{	34	}	=	[	0.15	0.08	];
Point	{	35	}	=	[	0.15	0.06	];
Point	{	36	}	=	[	0.15	0.03	];
Point	{	37	}	=	[	0.15	0	];
Point	{	38	}	=	[	0	0.15	];
Point	{	39	}	=	[	0.03	0.15	];
Point	{	40	}	=	[	0.06	0.15	];
Point	{	41	}	=	[	0.08	0.15	];
Point	{	42	}	=	[	0.1	0.15	];
Point	{	43	}	=	[	0.15	0.15	];
Point	{	44	}	=	[	0.2	0.15	];
Point	{	45	}	=	[	0.2	0.125	];
Point	{	46	}	=	[	0.2	0.1	];
Point	{	47	}	=	[	0.2	0.08	];
Point	{	48	}	=	[	0.2	0.06	];
Point	{	49	}	=	[	0.2	0.03	];
Point	{	50	}	=	[	0.2	0	];


Element = cell(1,36);
Element	{	1	}	=	[	1	2	7	6	];
Element	{	2	}	=	[	2	3	8	7	];
Element	{	3	}	=	[	3	4	9	8	];
Element	{	4	}	=	[	4	5	10	9	];
Element	{	5	}	=	[	6	7	12	11	];
Element	{	6	}	=	[	7	8	13	12	];
Element	{	7	}	=	[	8	15	14	13	];
Element	{	8	}	=	[	9	16	15	8	];
Element	{	9	}	=	[	10	17	16	9	];
Element	{	10	}	=	[	11	12	19	18	];
Element	{	11	}	=	[	12	13	20	19	];
Element	{	12	}	=	[	13	14	21	20	];
Element	{	13	}	=	[	14	23	22	21	];
Element	{	14	}	=	[	15	24	23	14	];
Element	{	15	}	=	[	16	25	24	15	];
Element	{	16	}	=	[	17	26	25	16	];
Element	{	17	}	=	[	18	19	28	27	];
Element	{	18	}	=	[	19	20	29	28	];
Element	{	19	}	=	[	20	21	30	29	];
Element	{	20	}	=	[	21	22	31	30	];
Element	{	21	}	=	[	22	33	32	31	];
Element	{	22	}	=	[	23	34	33	22	];
Element	{	23	}	=	[	24	35	34	23	];
Element	{	24	}	=	[	25	36	35	24	];
Element	{	25	}	=	[	26	37	36	25	];
Element	{	26	}	=	[	27	28	39	38	];
Element	{	27	}	=	[	28	29	40	39	];
Element	{	28	}	=	[	29	30	41	40	];
Element	{	29	}	=	[	30	31	42	41	];
Element	{	30	}	=	[	31	32	43	42	];
Element	{	31	}	=	[	32	45	44	43	];
Element	{	32	}	=	[	33	46	45	32	];
Element	{	33	}	=	[	34	47	46	33	];
Element	{	34	}	=	[	35	48	47	34	];
Element	{	35	}	=	[	36	49	48	35	];
Element	{	36	}	=	[	37	50	49	36	];


Ke = cell(1,36);
for i = 1:1:36
    x1 = Point{Element{i}(1)}(1);
    y1 = Point{Element{i}(1)}(2);
    x2 = Point{Element{i}(2)}(1);
    y2 = Point{Element{i}(2)}(2);
    x3 = Point{Element{i}(3)}(1);
    y3 = Point{Element{i}(3)}(2);
    x4 = Point{Element{i}(4)}(1);
    y4 = Point{Element{i}(4)}(2);
    
    Ke{i} = BilinearQuadElementStiffness(i,E,Nu,x1,y1,x2,y2,x3,y3,x4,y4,1);
    disp(i);
end

%load('Ke.mat');

K = zeros(100,100);
for i = 1:1:36
    K = BilinearQuadAssemble(K,Ke{i},Element{i}(1),Element{i}(2),Element{i}(3),Element{i}(4));
end

fe = 5000*0.3/7;
F = zeros(100,1);
F(44*2-1) = fe;
F(45*2-1) = fe;
F(46*2-1) = fe;
F(47*2-1) = fe;
F(48*2-1) = fe;
F(49*2-1) = fe;
F(50*2-1) = fe;


%需要求解的f的编号为 1,10,11,20,21,34,35,52,53,74,75,100
%已知力的编号为2~9  12~19  22~33  36~51  54~73  76~99
%              8    8      12     16     20     24

k = [K(2:9,2:9),K(2:9,12:19),K(2:9,22:33),K(2:9,36:51),K(2:9,54:73),K(2:9,76:99);
    K(12:19,2:9),K(12:19,12:19),K(12:19,22:33),K(12:19,36:51),K(12:19,54:73),K(12:19,76:99);
    K(22:33,2:9),K(22:33,12:19),K(22:33,22:33),K(22:33,36:51),K(22:33,54:73),K(22:33,76:99);
    K(36:51,2:9),K(36:51,12:19),K(36:51,22:33),K(36:51,36:51),K(36:51,54:73),K(36:51,76:99);
    K(54:73,2:9),K(54:73,12:19),K(54:73,22:33),K(54:73,36:51),K(54:73,54:73),K(54:73,76:99);
    K(76:99,2:9),K(76:99,12:19),K(76:99,22:33),K(76:99,36:51),K(76:99,54:73),K(76:99,76:99)];

f = [F(2:9);F(12:19);F(22:33);F(36:51);F(54:73);F(76:99)];

u = k\f;

U = [0;u(1:8);0;0;u(9:16);0;0;u(17:28);0;0;u(29:44);0;0;u(45:64);0;0;u(65:88);0];
F = K*U;
