E = 200E9;
Nu = 0.25;

Point = cell(1,44);
Point{1}=[0	0.05];
Point{2}=[0.019134172 0.046193977];
Point{3}=[0.035355339 0.035355339];
Point{4}=[0.046193977 0.019134172];
Point{5}=[0.05 0];
Point{6}=[0	0.06];
Point{7}=[0.03 0.06];
Point{8}=[0.06 0.06];
Point{9}=[0.06 0.03];
Point{10}=[0.06 0];
Point{11}=[0 0.08];
Point{12}=[0.03	0.08];
Point{13}=[0.06 0.08];
Point{14}=[0.08	0.08];
Point{15}=[0.08	0.06];
Point{16}=[0.08	0.03];
Point{17}=[0.08	0];
Point{18}=[0 0.1];
Point{19}=[0.06 0.1];
Point{20}=[0.1 0.1];
Point{21}=[0.1 0.08];
Point{22}=[0.1 0.06];
Point{23}=[0.1 0.03];
Point{24}=[0.1 0];
Point{25}=[0 0.125];
Point{26}=[0.06 0.125];
Point{27}=[0.1 0.125];
Point{28}=[0.15 0.125];
Point{29}=[0.15 0.1];
Point{30}=[0.15 0.08];
Point{31}=[0.15 0.06];
Point{32}=[0.15 0.03];
Point{33}=[0.15 0];
Point{34}=[0 0.15];
Point{35}=[0.06 0.15];
Point{36}=[0.1 0.15];
Point{37}=[0.15 0.15];
Point{38}=[0.2 0.15];
Point{39}=[0.2 0.125];
Point{40}=[0.2 0.1];
Point{41}=[0.2 0.08];
Point{42}=[0.2 0.06];
Point{43}=[0.2 0.03];
Point{44}=[0.2 0];

Element = cell(1,62);
Element	{	1	}	=	[	1	7	6	];
Element	{	2	}	=	[	1	2	7	];
Element	{	3	}	=	[	2	8	7	];
Element	{	4	}	=	[	2	3	8	];
Element	{	5	}	=	[	3	9	8	];
Element	{	6	}	=	[	3	4	9	];
Element	{	7	}	=	[	4	10	9	];
Element	{	8	}	=	[	4	5	10	];
Element	{	9	}	=	[	6	12	11	];
Element	{	10	}	=	[	6	7	12	];
Element	{	11	}	=	[	7	13	12	];
Element	{	12	}	=	[	7	8	13	];
Element	{	13	}	=	[	8	14	13	];
Element	{	14	}	=	[	8	15	14	];
Element	{	15	}	=	[	9	15	8	];
Element	{	16	}	=	[	9	16	15	];
Element	{	17	}	=	[	10	16	9	];
Element	{	18	}	=	[	10	17	16	];
Element	{	19	}	=	[	11	12	18	];
Element	{	20	}	=	[	12	19	18	];
Element	{	21	}	=	[	12	13	19	];
Element	{	22	}	=	[	13	14	19	];
Element	{	23	}	=	[	14	20	19	];
Element	{	24	}	=	[	14	21	20	];
Element	{	25	}	=	[	15	21	14	];
Element	{	26	}	=	[	15	22	21	];
Element	{	27	}	=	[	16	22	15	];
Element	{	28	}	=	[	16	23	22	];
Element	{	29	}	=	[	17	23	16	];
Element	{	30	}	=	[	17	24	23	];
Element	{	31	}	=	[	18	19	25	];
Element	{	32	}	=	[	25	19	26	];
Element	{	33	}	=	[	19	20	26	];
Element	{	34	}	=	[	26	20	27	];
Element	{	35	}	=	[	20	29	27	];
Element	{	36	}	=	[	27	29	28	];
Element	{	37	}	=	[	20	30	29	];
Element	{	38	}	=	[	21	30	20	];
Element	{	39	}	=	[	21	31	30	];
Element	{	40	}	=	[	22	31	21	];
Element	{	41	}	=	[	22	32	31	];
Element	{	42	}	=	[	23	32	22	];
Element	{	43	}	=	[	23	33	32	];
Element	{	44	}	=	[	24	33	23	];
Element	{	45	}	=	[	25	26	34	];
Element	{	46	}	=	[	34	26	35	];
Element	{	47	}	=	[	26	27	35	];
Element	{	48	}	=	[	35	27	36	];
Element	{	49	}	=	[	27	28	36	];
Element	{	50	}	=	[	36	28	37	];
Element	{	51	}	=	[	37	28	39	];
Element	{	52	}	=	[	37	39	38	];
Element	{	53	}	=	[	28	40	39	];
Element	{	54	}	=	[	28	29	40	];
Element	{	55	}	=	[	29	41	40	];
Element	{	56	}	=	[	29	30	41	];
Element	{	57	}	=	[	30	42	41	];
Element	{	58	}	=	[	30	31	42	];
Element	{	59	}	=	[	31	43	42	];
Element	{	60	}	=	[	31	32	43	];
Element	{	61	}	=	[	32	44	43	];
Element	{	62	}	=	[	32	33	44	];


Ke = cell(1,62);
for i = 1:1:62
    x1 = Point{Element{i}(1)}(1);
    y1 = Point{Element{i}(1)}(2);
    x2 = Point{Element{i}(2)}(1);
    y2 = Point{Element{i}(2)}(2);
    x3 = Point{Element{i}(3)}(1);
    y3 = Point{Element{i}(3)}(2);
    
    Ke{i} = LinearTriangleElementStiffness(E,Nu,x1,y1,x2,y2,x3,y3,1);
end

K = zeros(88,88);
for i = 1:1:62
    K = LinearTriangleAssemble(K,Ke{i},Element{i}(1),Element{i}(2),Element{i}(3));
end

fe = 5000*0.3/7;
F = zeros(88,1);
F(38*2-1) = fe;
F(39*2-1) = fe;
F(40*2-1) = fe;
F(41*2-1) = fe;
F(42*2-1) = fe;
F(43*2-1) = fe;
F(44*2-1) = fe;


%需要求解的f的编号为 1,10,11,20,21,34,35,48,49,66,67,88
%已知力的编号为2~9  12~19  22~33  36~47  50~65  68~87

k = [K(2:9,2:9),K(2:9,12:19),K(2:9,22:33),K(2:9,36:47),K(2:9,50:65),K(2:9,68:87);
    K(12:19,2:9),K(12:19,12:19),K(12:19,22:33),K(12:19,36:47),K(12:19,50:65),K(12:19,68:87);
    K(22:33,2:9),K(22:33,12:19),K(22:33,22:33),K(22:33,36:47),K(22:33,50:65),K(22:33,68:87);
    K(36:47,2:9),K(36:47,12:19),K(36:47,22:33),K(36:47,36:47),K(36:47,50:65),K(36:47,68:87);
    K(50:65,2:9),K(50:65,12:19),K(50:65,22:33),K(50:65,36:47),K(50:65,50:65),K(50:65,68:87);
    K(68:87,2:9),K(68:87,12:19),K(68:87,22:33),K(68:87,36:47),K(68:87,50:65),K(68:87,68:87)];

f = [F(2:9);F(12:19);F(22:33);F(36:47);F(50:65);F(68:87)];

u = k\f;

U = [0;u(1:8);0;0;u(9:16);0;0;u(17:28);0;0;u(29:40);0;0;u(41:56);0;0;u(57:76);0];
F = K*U;
